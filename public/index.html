<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Car Collection</title>
  <link rel="stylesheet" href="back.css">
  <link rel="icom" href="/public/favicon.ico" type="image/png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Car Collection">
  <link rel="manifest" href="/manifest.json">

</head>

<body>
  <h1>Car Collection</h1>
  <div class="cars-container">

    <!-- Ferrari -->
    <div class="car-section">
      <img src="img/ferari.jpg" alt="Ferrari">
      <div id="Ferrari-specs">
        <p id="FR">Ferrari 488 GTB</p>
        <div class="price">$250,000</div>
        <nav>
          <ul>
            <li><strong>Engine:</strong> 3.9-liter twin-turbo V8</li>
            <li><strong>Horsepower:</strong> 660 hp</li>
            <li><strong>Drive:</strong> Rear-wheel drive</li>
            <li><strong>0-60 mph:</strong> 3.0 seconds</li>
            <li><strong>Top Speed:</strong> 205 mph</li>
          </ul>
        </nav>
        <p id="description">
          The Ferrari 488 GTB is a mid-engine sports car that represents the pinnacle of
          Italian automotive engineering, offering breathtaking performance and stunning design.
        </p>
        <div class="payment-options">
          <button class="apple-pay-button" data-item="Ferrari" data-price="250000">
            Buy with Apple Pay
          </button>
        </div>
      </div>
    </div>

    <!-- Bugatti -->
    <div class="car-section">
      <img src="img/bugatti.jpg" alt="Bugatti">
      <div id="bugatti-specs">
        <p id="BG">Bugatti Chiron</p>
        <div class="price">$3,000,000</div>
        <nav>
          <ul>
            <li><strong>Engine:</strong> Quad-turbo 8.0L W16</li>
            <li><strong>Horsepower:</strong> 1,500 hp</li>
            <li><strong>Drive:</strong> All-wheel drive</li>
            <li><strong>0-60 mph:</strong> 2.4 seconds</li>
            <li><strong>Top Speed:</strong> 261 mph (limited)</li>
          </ul>
        </nav>
        <p id="description">
          The Bugatti Chiron redefines hypercar performance with its revolutionary
          engineering, unparalleled luxury, and record-breaking speed capabilities.
        </p>
        <button class="apple-pay-button" data-item="Bugatti" data-price="3000000">
          Buy with Apple Pay
        </button>
      </div>
    </div>

    <!-- Aston Martin -->
    <div class="car-section">
      <img src="img/Austin Martin.jpg" alt="Aston Martin">
      <div id="aston-specs">
        <p id="AM">Aston Martin DB5</p>
        <div class="price">$1,200,000</div>
        <nav>
          <ul>
            <li><strong>Engine:</strong> 4.0-liter inline-6</li>
            <li><strong>Horsepower:</strong> 282 hp</li>
            <li><strong>Drive:</strong> Rear-wheel drive</li>
            <li><strong>0-60 mph:</strong> 8.0 seconds</li>
            <li><strong>Top Speed:</strong> 145 mph</li>
          </ul>
        </nav>
        <p id="description">
          The iconic Aston Martin DB5, made famous by James Bond, represents British
          automotive elegance with its timeless design and superb craftsmanship from the golden age of motoring.
        </p>
        <div class="payment-options">
          <button class="apple-pay-button" data-item="Aston Martin" data-price="1200000">
            Buy with Apple Pay
          </button>
        </div>
      </div>
    </div>

  </div>

  <script>
    function handleApplePay(button) {
      const item = button.dataset.item;
      const price = button.dataset.price;

      if (!window.ApplePaySession || !ApplePaySession.canMakePayments()) {
        console.log("Apple Pay is not available");
        return;
      }

      const request = {
        countryCode: 'US',
        currencyCode: 'USD',
        supportedNetworks: ['visa', 'masterCard', 'amex'],
        merchantCapabilities: ['supports3DS'],
        total: { label: item, amount: price }
      };

      const session = new ApplePaySession(3, request);

      session.onvalidatemerchant = (event) => {
        fetch('/validate-merchant', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ validationURL: event.validationURL })
        })
          .then(res => res.json())
          .then(data => session.completeMerchantValidation(data));
      };

      session.onpaymentauthorized = (event) => {
        // Send event.payment to your server
        session.completePayment(ApplePaySession.STATUS_SUCCESS);
        alert(`Payment successful for ${item}!`);
      };

      session.begin();
    }

    // Attach handler to all Apple Pay buttons
    document.querySelectorAll('.apple-pay-button').forEach(btn => {
      btn.addEventListener('click', () => handleApplePay(btn));
    });
  </script>

  <script src="apple-pay-integration.js"></script>
  <script src="apple-pay-session.js"></script>
  <script src="applepay.js"></script>
  <script src="scripts/mock-apple-pay.js"></script>

</body>

</html>